<div align="center">

# nonebot-plugin-ba-tools

![NoneBotPluginBaToolsLogo](./ba-tools-logo.png)

[![license](https://img.shields.io/github/license/hanasa2023/nonebot-plugin-ba-tools.svg)](./LICENSE)
[![PyPI](https://img.shields.io/pypi/v/nonebot-plugin-ba-tools.svg)](https://pypi.python.org/pypi/nonebot-plugin-ba-tools)
[![NoneBot](https://img.shields.io/badge/nonebot-2.3.0+-red.svg)](https://nonebot.dev)
![Python](https://img.shields.io/badge/python-3.9+-blue.svg)

</div>

## ğŸ“– ä»‹ç»

> [!IMPORTANT]
> ç”±äºå­¦ä¸šç¹å¿™(2025)ï¼Œæœ¬é¡¹ç›®æš‚æ—¶åœæ­¢ç»´æŠ¤ï¼Œå¦‚æ‚¨æœ‰å…´è¶£ç»§ç»­ç»´æŠ¤æœ¬é¡¹ç›®ï¼Œè¯·è”ç³»æˆ‘
>
> QQ: [2969709268](https://qm.qq.com/cgi-bin/qm/qr?k=2969209268)
>
> email: [hanasakayui2022@gmail.com](mailto:hanasakayui2022@gmail.com)

ç›®æ ‡æ˜¯åš BlueArchive æœ€å¥½ç”¨çš„å·¥å…·ç®±

## ğŸ’¿ å®‰è£…

<details open>
<summary>ä½¿ç”¨ nb-cli å®‰è£…</summary>

åœ¨ nonebot2 é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ‰“å¼€å‘½ä»¤è¡Œ, è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤å³å¯å®‰è£…

```sh
    nb plugin install nonebot-plugin-ba-tools
```

</details>

<details>
<summary>ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…</summary>

åœ¨ nonebot2 é¡¹ç›®çš„æ’ä»¶ç›®å½•ä¸‹, æ‰“å¼€å‘½ä»¤è¡Œ, æ ¹æ®ä½ ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨, è¾“å…¥ç›¸åº”çš„å®‰è£…å‘½ä»¤

<details>
<summary>pip</summary>

```sh
  pip install nonebot-plugin-ba-tools
```

</details>

æ‰“å¼€ nonebot2 é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `pyproject.toml` æ–‡ä»¶, åœ¨ `[tool.nonebot]` éƒ¨åˆ†è¿½åŠ å†™å…¥

```python
    plugins = ["nonebot_plugin_ba_tools"]
```

</details>

## ğŸ‰ ä½¿ç”¨

### ğŸ’¡ æ•°æ®æ¥æº

~~æœ¬é¡¹ç›®åœ¨ [Schale DB](https://github.com/SchaleDB/SchaleDB) çš„åŸºç¡€ä¸Šæ–°å¢äº† l2d æ–‡ä»¶å¤¹ï¼Œè¯·åœ¨ release ä¸­ä¸‹è½½ç›¸åº”æ–‡ä»¶å¹¶è§£å‹è‡³ç›¸åº”ç›®å½•ä¸‹~~ v0.1.6 å·²å®ç°ç½‘ç»œè¯·æ±‚èµ„æºæ–‡ä»¶ï¼Œæ— éœ€å†è‡ªè¡Œé…ç½®èµ„æºæ–‡ä»¶

- é»˜è®¤è·¯å¾„ä¸ºé¡¹ç›®ç¼“å­˜è·¯å¾„ï¼Œä½¿ç”¨[nonebot_plugin_localstore](https://github.com/nonebot/plugin-localstore)è¿›è¡Œç®¡ç†ï¼Œä½ å¯ä»¥ä½¿ç”¨`nb localsotre`æŸ¥çœ‹é»˜è®¤ç¼“å­˜è·¯å¾„

- [A.R.O.N.A API](https://aronadoc.hanasaki.tech)

- æ¶©å›¾åŠŸèƒ½ä½¿ç”¨[è‡ªå»º pixiv æ•°æ®åº“](https://github.com/hanasa2023/ba-image-db)

### ğŸ”§ æ’ä»¶é…ç½®

> [!Caution]
> åœ¨v0.5.0-betaåŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œæ’ä»¶é…ç½®æ–¹å¼å‘ç”Ÿäº†å˜åŠ¨ï¼Œå¦‚é…ç½®äº†æ—§ç‰ˆæœ¬çš„é…ç½®æ–‡ä»¶ï¼Œéœ€è¦æ‰‹åŠ¨è¿ç§»é…ç½®

é…ç½®é»˜è®¤è·¯å¾„ä¸ºï¼š

- macOS: same as user_data_dir
- Unix: `~/.config/nonebot2/nonebot_plugin_ba_tools/`
- WinXP (roaming): `C:\Documents and Settings\<username>\Local Settings\Application Data\nonebot2\nonebot_plugin_ba_tools\`
- Win 7 (roaming): `C:\Users\<username>\AppData\Roaming\nonebot2\nonebot_plugin_ba_tools\`

> [!TIP]
> å¦‚æœä½ æƒ³è‡ªå®šä¹‰é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥å‘noneboté…ç½®æ–‡ä»¶ä¸­æ·»åŠ BA_TOOLS_CONFIG_PATHé¡¹ï¼Œå€¼ä¸ºä½ æƒ³è¦çš„è·¯å¾„

é»˜è®¤æ’ä»¶é…ç½®é¡¹å¦‚ä¸‹ï¼š

```yaml
pic:
  loading_switch: true
  max_pic_num: 5
  pixiv_nginx: "https://i.pixiv.re"
  send_pic_info: true
  r18_switch: false

chat:
  enable: false
  current_model: "<model_name>"
  models:
    - name: "<model_name>"
      base_url: "<model_endpoint>"
      api_key: "<your_api_key>"
  reply_mode: text

webui:
  enable: true
  path: "/batools"
  api_access_token: ""
  username: "admin"
  password: "admin"
```

#### å›¾ç‰‡é…ç½® (PicConfig)

| é…ç½®é¡¹         | é»˜è®¤å€¼                 | æè¿°                       |
| -------------- | ---------------------- | -------------------------- |
| loading_switch | `true`                 | æ˜¯å¦å¼€å¯å›¾ç‰‡åŠ è½½é€šçŸ¥       |
| max_pic_num    | `5`                    | å•æ¬¡æœ€å¤§è·å–çš„å›¾ç‰‡æ•°é‡     |
| pixiv_nginx    | `"https://i.pixiv.re"` | pixivå›¾åºŠåä»£              |
| send_pic_info  | `true`                 | å‘é€æ¶©å›¾æ—¶æ˜¯å¦å‘é€å›¾ç‰‡ä¿¡æ¯ |
| r18_switch     | `false`                | æ˜¯å¦å¼€å¯R18                |

#### èŠå¤©é…ç½® (ChatConfig)

| é…ç½®é¡¹        | é»˜è®¤å€¼   | æè¿°                 |
| ------------- | -------- | -------------------- |
| enable        | `false`  | æ˜¯å¦å¼€å¯LLM Chat     |
| current_model | `""`     | å½“å‰æ¨¡å‹             |
| models        | `[]`     | Chat Modelåˆ—è¡¨       |
| reply_mode    | `"text"` | å›å¤æ¨¡å¼(text/image) |

#### WebUIé…ç½® (WebUIConfig)

| é…ç½®é¡¹           | é»˜è®¤å€¼      | æè¿°                    |
| ---------------- | ----------- | ----------------------- |
| enable           | `true`      | æ˜¯å¦å¯ç”¨ BA Tools WebUI |
| path             | `"batools"` | WebUI è·¯å¾„              |
| api_access_token | `""`        | WebUI è®¿é—®ä»¤ç‰Œ          |
| username         | `"admin"`   | WebUI ç”¨æˆ·å            |
| password         | `"admin"`   | WebUI å¯†ç               |

#### èŠå¤©æ¨¡å‹é…ç½® (ChatModel)

| é…ç½®é¡¹   | ç±»å‹     | æè¿°         |
| -------- | -------- | ------------ |
| name     | `string` | æ¨¡å‹åç§°     |
| base_url | `string` | æ¨¡å‹æ¥å£åœ°å€ |
| api_key  | `string` | APIå¯†é’¥      |

### âœ¨ åŠŸèƒ½ä»‹ç»

- [x] æ¯æ—¥ 00:00 åœ¨ä»¥è®¢é˜…çš„ç¾¤èŠä¸­è‡ªåŠ¨æ¨é€å­¦ç”Ÿç”Ÿæ—¥ä¿¡æ¯
- [x] è·å–å½“æœˆè¿‡ç”Ÿæ—¥çš„å­¦ç”Ÿåˆ—è¡¨
- [x] è·å–å­¦ç”Ÿè¯¦ç»†ä¿¡æ¯
- [x] è·å–æ´»åŠ¨åˆ—è¡¨
- [x] è·å– ba åƒé‡Œçœ¼
- [x] è·å–æ”»ç•¥(å…³å¡æ”»ç•¥/æ€»åŠ›æˆ˜æ”»ç•¥/å¤§å†³æˆ˜æ”»ç•¥/ç«æŠ€åœºæ”»ç•¥/ç«åŠ›æ¼”ä¹ æ”»ç•¥)
- [ ] å¥½æ„Ÿåº¦è®¡ç®—
- [x] è·å–/æŠ½å– ba æ¼«ç”»(ç›®å‰åªèƒ½è·å–åˆ°ï¼ˆäºŒåˆ›ï¼Ÿï¼‰æ¼«ç”»ï¼Œå°†æ¥å¯èƒ½ä¼šæ”¯æŒæ›´å¤šçš„æ¼«ç”»)
- [ ] è·å– ba è¡¨æƒ…åŒ…
- [x] è‡ªåŠ¨æ¨é€æ€»åŠ›æˆ˜/å¤§å†³æˆ˜ä¿¡æ¯ ~~åŸºäº bilibili åŠ¨æ€~~ï¼ˆç›®å‰åªåšäº†æ—¥æœï¼‰
- [x] è·å– ba æ¶©å›¾ï¼ˆåŸºäºè‡ªå»ºçš„æ•°æ®åº“ï¼‰
- [x] è·å– ba memeï¼ˆåŸºäºè‡ªå»ºçš„å›¾åº“ï¼Œè´¨é‡å°½å¯èƒ½é«˜äº†ï¼‰
- [x] è·å– ba äººæƒ
- [x] è·å– ba æ€»åŠ›æˆ˜ä¿¡æ¯
- [x] ä½¿ç”¨llmè¿›è¡Œè§’è‰²æ‰®æ¼”å¯¹è¯
- [x] WebUI ç®¡ç†ç•Œé¢

### ğŸ¤– æŒ‡ä»¤è¡¨

> [!WARNING]
> æ­¤å¤„ç¤ºä¾‹ä¸­çš„"/"ä¸º nb é»˜è®¤çš„å‘½ä»¤å¼€å§‹æ ‡å¿—ï¼Œè‹¥æ‚¨è®¾ç½®äº†å¦å¤–çš„æ ‡å¿—ï¼Œåˆ™è¯·ä½¿ç”¨æ‚¨è®¾ç½®çš„æ ‡å¿—ä½œä¸ºå¼€å¤´

|                  æŒ‡ä»¤                   |           æƒé™            | éœ€è¦@ |                      è¯´æ˜                       |             ç¤ºä¾‹             |
| :-------------------------------------: | :-----------------------: | :---: | :---------------------------------------------: | :--------------------------: |
|        `baå­¦ç”Ÿç”Ÿæ—¥è®¢é˜… <æ“ä½œå>`        | ç®¡ç†å‘˜/ç¾¤ä¸»ä»¥åŠ SUPERUSER |  æ—    |         åœ¨æ­¤ç¾¤è®¢é˜…/å–æ¶ˆè®¢é˜…å­¦ç”Ÿç”Ÿæ—¥æ¨é€         | `/baå­¦ç”Ÿç”Ÿæ—¥è®¢é˜… å¼€å¯/å…³é—­`  |
|         `baæ€»åŠ›æˆ˜è®¢é˜… <æ“ä½œå>`         | ç®¡ç†å‘˜/ç¾¤ä¸»ä»¥åŠ SUPERUSER |  æ—    |      åœ¨æ­¤ç¾¤è®¢é˜…/å–æ¶ˆè®¢é˜…æ€»åŠ›æˆ˜/å¤§å†³æˆ˜æ¨é€       |  `/baæ€»åŠ›æˆ˜è®¢é˜… å¼€å¯/å…³é—­`   |
|          `baåƒé‡Œçœ¼ <æœåŠ¡å™¨å>`          |            æ—              |  æ—    |               è·å– ba åƒé‡Œçœ¼ä¿¡æ¯                |   `/baåƒé‡Œçœ¼ å›½æœ/å›½é™…æœ`    |
|              `baæ´»åŠ¨ä¸€è§ˆ`               |            æ—              |  æ—    |                è·å– ba æ´»åŠ¨ä¿¡æ¯                 |        `/baæ´»åŠ¨ä¸€è§ˆ`         |
|           `baæ”»ç•¥ <æ”»ç•¥åç§°>`           |            æ—              |  æ—    |                  è·å– ba æ”»ç•¥                   | `/baæ”»ç•¥ å…³å¡2-1/å›½æœå¤§å†³æˆ˜` |
|              `baå¯ç”¨æ”»ç•¥`               |            æ—              |  æ—    |                 æŸ¥è¯¢å¯ç”¨çš„æ”»ç•¥                  |        `/baå¯ç”¨æ”»ç•¥`         |
|         `baæ¼«ç”» <å‚æ•°(è§ç¤ºä¾‹)>`         |            æ—              |  æ—    |              è·å– baï¼ˆäºŒåˆ›ï¼Ÿï¼‰æ¼«ç”»              |    `/baæ¼«ç”» æŠ½å–/ç¬¬104è¯`    |
|      `baå­¦ç”Ÿç”Ÿæ—¥è¡¨ <å‚æ•°(è§ç¤ºä¾‹)>`      |            æ—              |  æ—    |              è·å–æŸæœˆçš„å­¦ç”Ÿç”Ÿæ—¥è¡¨               |   `/baå­¦ç”Ÿç”Ÿæ—¥è¡¨ å½“æœˆ/9æœˆ`   |
| `baæ¶©å›¾ [num] [tags] [isAI] [restrict]` |            æ—              |  æ—    |         è·å– ba æ¶©å›¾ï¼Œä½¿ç”¨æ–¹æ³•è¯¦è§ä¸‹æ–¹          | `/baæ¶©å›¾ num 2`æˆ–è€…`/baæ¶©å›¾` |
|           `baæ¶©å›¾ä¸Šä¼  <pid>`            |            æ—              |  æ—    |       ä¸Šä¼ æ¶©å›¾è‡³æ•°æ®åº“ï¼Œå‚æ•°ä¸ºå›¾ç‰‡çš„ pid        |   `/baæ¶©å›¾ä¸Šä¼  124081225`    |
|             `bameme [num]`              |            æ—              |  æ—    | è·å– ba memeï¼Œå‚æ•°ä¸ºè¦è·å–çš„æ•°ç›®ï¼Œä¸å¡«é»˜è®¤ 1 å¼  |   `/bameme 2`æˆ–è€…`/bameme`   |
|              `baè§’è‰²ç®€è¯„`               |            æ—              |  æ—    |                  è·å–è§’è‰²ç®€è¯„                   |        `/baè§’è‰²ç®€è¯„`         |
|                `baäººæƒ`                 |            æ—              |  æ—    |                  è·å– ba äººæƒ                   |          `/baäººæƒ`           |
|     `baå­¦ç”Ÿä¿¡æ¯ <å­¦ç”Ÿå§“å> [level]`     |            æ—              |  æ—    |                  è·å–å­¦ç”Ÿä¿¡æ¯                   |      `/baå­¦ç”Ÿä¿¡æ¯ æ™´å¥ˆ`      |
|         `baå­¦ç”ŸæŠ€èƒ½ <å­¦ç”Ÿå§“å>`         |            æ—              |  æ—    |                è·å–å­¦ç”ŸæŠ€èƒ½ä¿¡æ¯                 |      `/baå­¦ç”ŸæŠ€èƒ½ æ™´å¥ˆ`      |
|              `/baå­¦ç”Ÿåˆ—è¡¨`              |            æ—              |  æ—    |                è·å–å¯ç”¨å­¦ç”Ÿåˆ—è¡¨                 |        `/baå­¦ç”Ÿåˆ—è¡¨`         |
|        `baæ€»åŠ›æˆ˜æ¡£çº¿ <æœåŠ¡å™¨å>`        |            æ—              |  æ—    |               è·å–æ€»åŠ›æˆ˜æ¡£çº¿ä¿¡æ¯                |     `/baæ€»åŠ›æˆ˜æ¡£çº¿ Bæœ`      |
|      `baæ€»åŠ›æˆ˜æ¡£çº¿å˜åŒ– <æœåŠ¡å™¨å>`      |            æ—              |  æ—    |            è·å–æ€»åŠ›æˆ˜æ¡£çº¿å˜åŒ–çš„å›¾è¡¨             |   `/baæ€»åŠ›æˆ˜æ¡£çº¿å˜åŒ– Bæœ`    |
|      `baæ€»åŠ›æˆ˜äººæ•°å˜åŒ– <æœåŠ¡å™¨å>`      |            æ—              |  æ—    |          è·å–æ€»åŠ›æˆ˜å‚ä¸äººæ•°å˜åŒ–çš„å›¾è¡¨           |   `/baæ€»åŠ›æˆ˜äººæ•°å˜åŒ– Bæœ`    |
|      `baæ€»åŠ›æˆ˜åˆ†æ•°è®¡ç®— <æœåŠ¡å™¨å>`      |            æ—              |  æ—    |                 è®¡ç®—ç›¸åº”çš„åˆ†æ•°                  |     `/baæ€»åŠ›æˆ˜åˆ†æ•°è®¡ç®—`      |
|              `baå¯ç”¨boss`               |            æ—              |  æ—    |               è·å–å¯ç”¨çš„ boss å                |        `/baå¯ç”¨boss`         |
|            `baå­¦ç”Ÿç”Ÿæ—¥åˆ†å¸ƒ`             |            æ—              |  æ—    |               è·å–å­¦ç”Ÿç”Ÿæ—¥åˆ†å¸ƒå›¾                |      `/baå­¦ç”Ÿç”Ÿæ—¥åˆ†å¸ƒ`       |
|      `bachat <subcommand> [args]`       |            æ—              |  æ—    |                   è°ƒæ•´llmè®¾ç½®                   |         `/bachat -h`         |

- å„æŒ‡ä»¤(ä¸æ”¯æŒæ‰€æœ‰æœçš„æŒ‡ä»¤)å‚æ•°å¯ç”¨åˆ—è¡¨å¦‚ä¸‹

```

baæ”»ç•¥ï¼šå…³å¡<å…³å¡å·>/å›½é™…æœæ€»åŠ›æˆ˜/æ—¥æœæ€»åŠ›æˆ˜/å›½é™…æœå¤§å†³æˆ˜/æ—¥æœå¤§å†³æˆ˜/å›½é™…æœç«åŠ›æ¼”ä¹ /æ—¥æœç«åŠ›æ¼”ä¹ /ç«æŠ€åœº/ä¸‰ä¸€ç¤¼ç‰©/äº’åŠ¨å®¶å…·/å‡æ˜Ÿä¸€å›¾æµ/...
baæ€»åŠ›æ¡£çº¿ï¼šæ—¥æœ/å®˜æœ/bæœ/Bæœ

```

- ba æ¶©å›¾çš„å…·ä½“ä½¿ç”¨æ–¹æ³•

|  å‚æ•°å  |       å‚æ•°å€¼ç±»å‹       | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ |
| :------: | :--------------------: | :------: | :----- |
|   num    |          int           |    å¦    | 1      |
|   tags   |       list[str]        |    å¦    | -      |
|   isAI   |          bool          |    å¦    | false  |
| restrict | Literal["safe", "r18"] |    å¦    | "safe" |

ä¾‹ï¼š

```

/baæ¶©å›¾
/baæ¶©å›¾ num 2 tags [BlueArchive] isAI true restrict safe
/baæ¶©å›¾ num 2
/baæ¶©å›¾ tags [å°é¸Ÿæ¸¸æ˜Ÿé‡, BlueArchive]
/baæ¶©å›¾ isAI true restrict r18

```

## ğŸ‘¥ å‚ä¸å…±å»º

è¯·åŠ å…¥ QQ ç¾¤`991680169`è¿›è¡Œäº¤æµ

## ğŸš© TODO

- [ ] ä½¿ç”¨ nonebot-plugin-orm é‡æ„æ’ä»¶æ•°æ®
